PREFIX epo: <http://data.europa.eu/a4g/ontology#>
PREFIX cccev: <http://data.europa.eu/m8g/>
PREFIX org: <http://www.w3.org/ns/org#>
PREFIX cpv: <http://data.europa.eu/m8g/>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>

SELECT DISTINCT
?LegalName
?PublicationDate
?CountryCode
?MainClassification
?MainClassificationLabel
?LotAwardedValue
?LotAwardedValueCurrency

WHERE {

    ?Notice epo:hasPublicationDate ?PublicationDate .
    ?Notice epo:announcesRole ?Buyer .
    ?Buyer a epo:Buyer ;
            epo:playedBy ?Organization .
    ?Organization cccev:registeredAddress / epo:hasCountryCode ?CountryCode .
    ?Organization epo:hasLegalName ?LegalName .

    ?LotAwardOutcome epo:describesLot ?LotURI ;
                     epo:hasAwardedValue ?MonetaryValue .
    ?MonetaryValue a epo:MonetaryValue;
                   epo:hasAmountValue ?LotAwardedValue;
                   epo:hasCurrency ?LotAwardedValueCurrency .
    
    ?ProcurementObject epo:hasPurpose ?Purpose .
    ?Purpose epo:hasMainClassification ?MainClassification .
    FILTER(strstarts(str(?MainClassification), 'http://data.europa.eu/cpv/cpv/8010')) .
    
    ?MainClassification skos:inScheme <http://data.europa.eu/cpv/cpv> .
    ?MainClassification skos:prefLabel ?MainClassificationLabel .
    FILTER (lang(?MainClassificationLabel) = "en")    

}

LIMIT 1000